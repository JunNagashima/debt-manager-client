# 共通コンポーネント

## 概要

本ドキュメントでは、わりかんノートアプリケーションで使用される共通コンポーネントとその仕様を定義します。

---

## ナビゲーション

### ボトムナビゲーション

**配置**
- 画面下部に固定表示
- 全画面共通（一部画面を除く）

**構成**
4つのタブアイテム：

1. ホーム
   - アイコン: ホームアイコン
   - ラベル: 「ホーム」
   - 遷移先: ホーム画面

2. 履歴
   - アイコン: 時計アイコン
   - ラベル: 「履歴」
   - 遷移先: 履歴画面

3. フレンド
   - アイコン: 人アイコン
   - ラベル: 「フレンド」
   - 遷移先: フレンド画面

4. 設定
   - アイコン: 歯車アイコン
   - ラベル: 「設定」
   - 遷移先: 設定画面

**状態**
- 選択中: アイコンとラベルが強調色
- 非選択: グレー

---

## モーダル

### 共通モーダル構造

**構成**
- モーダルオーバーレイ（半透明背景、#000 opacity 0.5）
- モーダルコンテナ
  - ヘッダー
    - タイトル（左寄せ）
    - 閉じるボタン（×アイコン、右寄せ）
  - ボディ
    - コンテンツエリア
    - スクロール可能
  - フッター
    - ボタンエリア（横並び）

**サイズ**
- モバイル: 画面の90%幅、最大高さ80%
- タブレット: 固定幅600px、最大高さ80%
- デスクトップ: 固定幅800px、最大高さ80%

### モーダル制御関数

**JavaScript API**

```javascript
// モーダルを開く
openModal(modalId: string): void

// モーダルを閉じる
closeModal(modalId: string): void

// オーバーレイクリックで閉じる
closeModalOnOverlay(event: Event): void
```

**使用例**
```javascript
// ボタンクリックでモーダルを開く
<button onclick="openModal('modal-advance')">立替を申請</button>

// 閉じるボタン
<button onclick="closeModal('modal-advance')">キャンセル</button>

// オーバーレイクリックで閉じる
<div class="modal-overlay" onclick="closeModalOnOverlay(event)">
```

**キーボード操作**
- ESCキー: 開いているモーダルを閉じる

**動作**
- モーダル表示時: body要素にoverflow: hiddenを設定（背景スクロール防止）
- モーダル非表示時: overflow設定を解除

---

## フォーム要素

### 金額入力

**構成**
- ¥プレフィックス（固定表示）
- 数値入力フィールド
  - type: number
  - min: 1
  - placeholder: "0"

**バリデーション**
- 必須項目
- 最小値: 1
- 整数のみ
- 最大値: 9,999,999（推奨）

**表示例**
```
┌─────────────────┐
│ ¥ [     3000   ]│
└─────────────────┘
```

### 日付入力

**構成**
- type: date
- デフォルト値: 当日（YYYY-MM-DD形式）
- max属性: 当日（未来日を選択不可）

**JavaScript初期化**
```javascript
document.addEventListener('DOMContentLoaded', () => {
  const today = new Date().toISOString().split('T')[0];
  document.querySelectorAll('input[type="date"]').forEach(input => {
    if (!input.value) input.value = today;
    input.setAttribute('max', today);
  });
});
```

**ヒント**
- 「未来の日付は選択できません」

### フレンド選択

**構成**
- セレクトボックス（ドロップダウン）
- プレースホルダー: 「フレンドを選択」

**オプション項目**
- フレンド名
- （オプション）残高情報: 例「佐藤 花子（¥6,000 貸し）」

**データソース**
- `GET /api/v1/friends` からフレンド一覧取得
- （オプション）`GET /api/v1/balances` から残高情報取得

### テキスト入力

**共通スタイル**
- border-radius: 8px
- padding: 12px 16px
- border: 1px solid #e0e0e0
- focus時: border-color変更、box-shadow追加

**メモ入力**
- type: text
- maxlength: 100（推奨）
- placeholder: 状況に応じた例文

---

## 状態表示

### ステータスバッジ

**種類と色**

| ステータス | 色 | 背景色 | 使用場面 |
|---|---|---|---|
| 承認待ち（PENDING） | #fff | #ff9800 | 申請の未承認状態 |
| 承認済み（APPROVED） | #fff | #4caf50 | 申請の承認済み |
| 却下（REJECTED） | #fff | #f44336 | 申請の却下 |
| 取消（CANCELED） | #333 | #e0e0e0 | 申請の取消 |
| 確定済み | #fff | #9e9e9e | 取引の確定 |

**スタイル**
- border-radius: 12px
- padding: 4px 12px
- font-size: 12px
- font-weight: 500

### 残高表示

**色の定義**

| 状態 | 色 | 使用場面 |
|---|---|---|
| 貸し（lent） | #4caf50（緑） | 相手に貸している |
| 借り（borrowed） | #f44336（赤） | 相手から借りている |
| 清算済み（settled） | #9e9e9e（グレー） | 残高0 |

**表示例**
- 「¥6,000 貸し」（緑色）
- 「¥2,500 借り」（赤色）
- 「¥0 清算済み」（グレー）

### 金額表示

**方向性の表示**

| 方向 | 記号 | 色 | 意味 |
|---|---|---|---|
| 受取（プラス） | + | #4caf50（緑） | 自分が受け取る |
| 支払（マイナス） | - | #f44336（赤） | 自分が支払う |

**フォーマット**
- 3桁カンマ区切り
- 例: 「+¥12,500」「-¥3,200」

---

## ボタン

### ボタンの種類

**プライマリボタン**
- 背景色: #8b5a3c（ブラウン）
- テキスト色: #fff
- 用途: 主要なアクション

**セカンダリボタン**
- 背景色: transparent
- テキスト色: #8b5a3c
- border: 1px solid #8b5a3c
- 用途: 副次的なアクション、キャンセル

**デンジャーボタン**
- 背景色: #f44336（赤）
- テキスト色: #fff
- 用途: 削除、却下などの危険な操作

**ゴーストボタン**
- 背景色: transparent
- テキスト色: #f44336（デンジャー時）
- border: なし
- 用途: 取消などの控えめな破壊的アクション

### ボタンのサイズ

**デフォルト**
- padding: 12px 24px
- border-radius: 8px
- font-size: 16px

**フル幅**
- width: 100%
- 用途: モーダルのボタンなど

**小サイズ**
- padding: 8px 16px
- font-size: 14px
- 用途: カード内のボタン

---

## アラート・通知

### 影響通知（Warning）

**構成**
- 警告アイコン（⚠️ または円形感嘆符）
- タイトル: 例「承認すると...」
- 説明文
- 強調表示（太字）

**スタイル**
- 背景色: #fff3cd（薄い黄色）
- border: 1px solid #ffc107
- border-radius: 8px
- padding: 16px

**使用例**
```
┌────────────────────────────┐
│ ⚠️ 承認すると...            │
│ あなたの借りが ¥3,000 増えます │
└────────────────────────────┘
```

### 成功通知（Toast）

**構成**
- 成功アイコン（✓）
- メッセージテキスト

**スタイル**
- 背景色: #4caf50（緑）
- テキスト色: #fff
- border-radius: 8px
- padding: 12px 16px
- 画面上部または下部に表示

**動作**
- 表示時間: 3秒
- フェードイン/フェードアウト
- 自動的に消える

### エラー通知

**構成**
- エラーアイコン（×）
- エラーメッセージ

**スタイル**
- 背景色: #f44336（赤）
- テキスト色: #fff
- border-radius: 8px
- padding: 12px 16px

**動作**
- ユーザーが閉じるまで表示
- 閉じるボタン付き

---

## カードコンポーネント

### 基本カード

**スタイル**
- 背景色: #fff
- border-radius: 12px
- box-shadow: 0 2px 8px rgba(0,0,0,0.1)
- padding: 16px

**ホバー時**
- box-shadow: 0 4px 12px rgba(0,0,0,0.15)
- cursor: pointer（クリック可能な場合）

### ユーザーカード

**構成**
- アバター（左側、円形）
- ユーザー情報（中央）
  - ユーザー名
  - ユーザーID
- アクションエリア（右側）

---

## アイコン

### アイコンライブラリ

**使用するアイコンセット**
- SVGアイコン（インライン）
- サイズ: 16px, 20px, 22px, 24px

**主要アイコン**
- ホーム: 家アイコン
- 履歴: 時計アイコン
- フレンド: 人アイコン
- 設定: 歯車アイコン
- 通知: ベルアイコン
- 立替: ドルマークアイコン
- 返済: カードアイコン
- 相殺: 天秤アイコン
- 検索: 虫眼鏡アイコン
- メニュー: 3点ドットアイコン
- 閉じる: ×アイコン
- 戻る: 左矢印アイコン
- 前へ: 左矢印アイコン
- 次へ: 右矢印アイコン
- 確認: ✓アイコン
- 却下: ×アイコン

---

## レイアウト

### コンテナ

**メインコンテナ**
- max-width: 1200px
- margin: 0 auto
- padding: 16px

### グリッド

**2カラムグリッド**
- display: grid
- grid-template-columns: 1fr 1fr
- gap: 16px

### スペーシング

**マージン/パディング基準**
- xs: 4px
- sm: 8px
- md: 16px
- lg: 24px
- xl: 32px

---

## 色の定義

### プライマリカラー

- **ブラウン**: #8b5a3c
- **ライトブラウン**: #d4a574

### セマンティックカラー

- **成功（緑）**: #4caf50
- **エラー（赤）**: #f44336
- **警告（オレンジ）**: #ff9800
- **情報（青）**: #2196f3

### テキストカラー

- **プライマリ**: #333333
- **セカンダリ**: #666666
- **ミュート**: #999999

### 背景色

- **ホワイト**: #ffffff
- **ライトグレー**: #f5f5f5
- **グレー**: #e0e0e0

---

## タイポグラフィ

### フォント

**フォントファミリー**
```css
font-family: 'Zen Maru Gothic', sans-serif;
```

### フォントサイズ

| 用途 | サイズ | Weight |
|---|---|---|
| H1 | 32px | 700 |
| H2 | 24px | 700 |
| H3 | 20px | 500 |
| Body | 16px | 400 |
| Small | 14px | 400 |
| Caption | 12px | 400 |

---

## アニメーション

### トランジション

**デフォルト**
```css
transition: all 0.3s ease;
```

**ホバー**
```css
transition: transform 0.2s ease, box-shadow 0.2s ease;
```

### フェードイン/アウト

**フェードイン**
```css
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
animation: fadeIn 0.3s ease;
```

**フェードアウト**
```css
@keyframes fadeOut {
  from { opacity: 1; }
  to { opacity: 0; }
}
animation: fadeOut 0.3s ease;
```

---

## アクセシビリティ

### ARIA属性

**ボタン**
```html
<button aria-label="戻る" onclick="history.back()">
  <svg>...</svg>
</button>
```

**モーダル**
```html
<div role="dialog" aria-labelledby="modal-title" aria-modal="true">
  <h2 id="modal-title">タイトル</h2>
  ...
</div>
```

### キーボード操作

- Tab: フォーカス移動
- Enter/Space: ボタン実行
- Esc: モーダル閉じる
- 矢印キー: リスト内移動（オプション）

### コントラスト比

- 通常テキスト: 4.5:1以上
- 大きなテキスト: 3:1以上

---

## 実装時の注意事項

1. **レスポンシブデザイン**
   - モバイルファースト
   - ブレークポイント: 768px（タブレット）、1024px（デスクトップ）

2. **パフォーマンス**
   - アイコンはSVGでインライン化
   - 画像の遅延読み込み
   - CSSアニメーションはtransformとopacityのみ使用

3. **ブラウザ対応**
   - Chrome, Safari, Firefox, Edgeの最新版
   - iOS Safari 14+
   - Android Chrome 90+

4. **エラーハンドリング**
   - 全てのユーザーアクションに対して適切なフィードバック
   - エラーメッセージは具体的に

5. **セキュリティ**
   - XSS対策: ユーザー入力のエスケープ
   - CSRF対策: トークン検証
   - HTTPSのみ
